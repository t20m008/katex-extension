const window_width=window.innerWidth-15,window_width_adjusted=window_width;let katex=[],katex_list=[],katex_html_collection_list=[],mathml_list=[],katex_mathml_html_collection_list=[],katexClass=[],katexHTMLClass=[],katexMathMLClass=[];async function getKatex(){katex=await document.getElementsByClassName("katex"),katex=Array.from(katex),katex_html_collection_list=await document.getElementsByClassName("katex-html"),katex_list=Array.from(katex_html_collection_list),katex_mathml_html_collection_list=await document.getElementsByClassName("katex-mathml"),mathml_list=Array.from(katex_mathml_html_collection_list)}async function loadKaTeX(){katexClass=await document.getElementsByClassName("katex"),katexClass=Array.from(katexClass),katexHTMLClass=await document.getElementsByClassName("katex-html"),katexHTMLClass=Array.from(katexHTMLClass),katexMathMLClass=await document.getElementsByClassName("katex-mathml"),katexMathMLClass=Array.from(katexMathMLClass)}const addOrdinalNumberClass=async()=>{katex.forEach((e,t)=>{if(katex[t].children[1].children.length>0){"katex-display"===katex[t].parentElement.classList[0]&&katex[t].parentElement.classList.add(`kd-${t}`),katex[t].classList.add(`k-${t}`);const e=Array.from(katex[t].children);e.forEach((a,s)=>{"katex-mathml"===a.className?e[s].classList.add(`km-${t}`):"katex-html"===a.className&&e[s].classList.add(`kh-${t}`)})}})},addStyle=async()=>{},addClassHorizontal=async()=>{let e=0,t=0,a=0,s=!0,l=0,n=!1,o=0;katex_list.forEach((c,r)=>{const i=Array.from(c.children);e=0,t=0,a=0,i.forEach(s=>{"base"===s.className&&e++,Array.from(s.children).forEach(e=>{"="===e.textContent&&t++,"⇒"===e.textContent&&a++})}),e>2&&(t>1||a>1)&&(c.classList.add("horizontal"),l=0,o=0,s=!0,i.forEach((e,t)=>{Array.from(e.children).forEach((e,r)=>{0===a?(c.classList.add("equation"),s?"="===e.textContent&&(s=!1,l=t):"="===e.textContent?(n=!1,o=t):n=!0):a>0&&c.classList.add("logical")})}),0!==o&&i.forEach((e,t)=>{if(t<l)e.classList.add("leftmost");else if(t==l)e.classList.add("leftmost","phrase_end");else if(t>l&&t<=o){Array.from(e.children).forEach((t,a)=>{"="===t.textContent&&e.classList.add("phrase_end")})}else o<t&&e.classList.add("rightmost")}))})},addClassVertical=async()=>{katexHTMLClass.forEach((e,t)=>{if(Array.from(e.getElementsByClassName("mtable")).forEach((e,t)=>{}),void 0===e.getElementsByClassName("mtable")[0]);else{const a=Array.from(e.getElementsByClassName("mtable"));let s=!1,l=!1,n=!1;a.forEach((a,o)=>{if(a.classList.contains("matrix-mtable"));else if(!a.classList.contains("matrix-mtable")&&0===o){const o=Array.from(a.children);if(o.forEach(e=>{"col-align-r"===e.className&&(l=!0),"col-align-l"===e.className&&(n=!0)}),!0===l&&!0===n&&(s=!0),s){e.classList.add("multi-line");const a=[],s=[],l=[];o.forEach(e=>{"col-align-r"===e.className?a.push(e):"col-align-l"===e.className&&s.push(e)});let n=0,c=0;3===a.length&&2===s.length?(a.length>1&&s.length>1&&(a.forEach((e,a)=>{n=0;const s=Array.from(e.getElementsByClassName("mord"));0===a?s.forEach((e,a)=>{e.textContent.length>0&&"mord"===e.className&&e.clientHeight>1&&e.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("col")&&(l.push(e.parentElement.style.top),e.classList.add(`formula-${t}`,`row-${n}`,"left"),n++)}):s.forEach((e,a)=>{e.textContent.length>0&&"mord"===e.className&&e.clientHeight>1&&e.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("col")&&(e.classList.add(`formula-${t}`,`row-${l.indexOf(e.parentElement.style.top)}`,"right"),n++)})}),s.forEach((e,a)=>{c=0,Array.from(e.getElementsByClassName("mord")).forEach((e,a)=>{e.textContent.length>0&&"mord"===e.className&&e.clientHeight>1&&e.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("col")&&(e.classList.add(`formula-${t}`,`row-${l.indexOf(e.parentElement.style.top)}`,"right"),c++)})})),e.classList.add("mcsymmetric")):(a.length>1?a.forEach((e,a)=>{n=0===a?1:0;const s=Array.from(e.getElementsByClassName("mord"));try{s.forEach((e,a)=>{e.textContent.length>0&&"mord"===e.className&&e.clientHeight>1&&e.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("col")&&(e.classList.add(`formula-${t}`,`row-${n}`,"left"),n++)})}catch(e){console.error(e)}}):a.forEach((e,a)=>{Array.from(e.getElementsByClassName("mord")).forEach((e,a)=>{e.textContent.length>0&&"mord"===e.className&&e.clientHeight>1&&e.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("col")&&(e.classList.add(`formula-${t}`,`row-${n}`,"left"),n++)})}),s.length>=1?s.forEach((e,a)=>{const s=Array.from(e.getElementsByClassName("mord"));try{s.forEach((e,a)=>{"⋮"!==e.textContent&&e.textContent.length>0&&"mord"===e.className&&e.clientHeight>1&&e.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("col")?(e.classList.add(`formula-${t}`,`row-${c}`,"right"),c++):"⋮"===e.textContent&&e.classList.add("dots")})}catch(e){console.error(e)}}):s.forEach(e=>{Array.from(e.getElementsByClassName("mord")).forEach((e,a)=>{e.textContent.length>0&&"mord"===e.className&&e.clientHeight>1&&e.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("col")&&e.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.className.includes("base")&&!e.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.classList.contains("matrix-mtable")&&(console.log(e),e.classList.add(`formula-${t}`,`row-${c}`,"right"),c++)})}),n===c?e.classList.add("symmetric"):0===n&&c>0?e.classList.add("straight"):e.classList.add("asymmetric"))}}})}})},addStyleOverFlowXAuto=()=>{const e=document.getElementsByClassName("overflow-x");Array.from(e).forEach(e=>{e.style.overflowX="auto",e.style.overflowY="visible",e.style.position="contents"})};function allCollapse(){Array.from(document.getElementsByClassName("katex-extension-button")).forEach((e,t)=>{try{!0===e.classList.contains("collapse-btn")&&e.click()}catch(e){}})}function allExpand(){Array.from(document.getElementsByClassName("katex-extension-button")).forEach((e,t)=>{try{!0===e.classList.contains("expand-btn")&&e.click()}catch(e){}})}const saveKatexStatus=(e,t)=>{const a=JSON.parse(localStorage["katex-status"]);a[window.location.href][e]=t;const s=JSON.stringify(a);localStorage.setItem("katex-status",s)},getKatexOverFlowX=()=>{const e=[],t=document.getElementsByClassName("katex-html"),a=Array.from(t);return a.forEach((t,s)=>{const l=Array.from(t.children);let n=0;l.forEach((e,t)=>{n+=e.offsetWidth}),n>window_width_adjusted&&(a[s].classList.add("overflow-x"),e.push(s))}),e},getPhraseEndList=e=>{const t=[];return e.forEach((e,a)=>{e.classList.contains("phrase_end")&&t.push(a)}),t},getLeftmostList=e=>{const t=[];return e.forEach((e,a)=>{e.classList.contains("leftmost")&&t.push(a)}),t};async function reshape(e){await e.forEach(e=>{const t=Array.from(katex_list[e].children);window.innerWidth;let a=0;const s=[];if(console.log("window.width = ",window.innerWidth,"katex-html-width = ",katex_list[e].clientWidth),t.length>1){console.log(t),t.forEach((t,l)=>{a+=t.clientWidth,console.log("width: ",t.clientWidth," sum: ",a),katex_list[e].clientWidth-50<a&&(a=t.clientWidth,s.push(l))}),console.log("chapter:",s);let l="";const n=[];s.forEach((e,a)=>{if(l="",a<s.length-1){for(let n=e;n<s[a+1];n++)l+=t[n].outerHTML;n.push("<p>"+l+"</p>")}else{for(let a=e;a<t.length;a++)l+=t[a].outerHTML;n.push("<p>"+l+"</p>")}});for(let e=s[0]+1;e<t.length;e++)t[e].remove();const o=n.join("");t[s[0]].outerHTML=o}else t.length})}async function reshape2(e,t=!0){await e.forEach(e=>{const t=Array.from(katex_list[e].children);window.innerWidth;let a=0;const s=[],l=[],n=[];console.log("window.width = ",window.innerWidth,"katex-html-width = ",katex_list[e].scrollWidth);const o=getPhraseEndList(t),c=getLeftmostList(t);katex_list[e].children[c.slice(-1)[0]];if(o.forEach(e=>{t[e+1].children[0].outerHTML=t[e+1].children[0].outerHTML+'<span class="mrel">=</span>',Array.from(t[e].children).slice(-2)[0].remove()}),t.length>1){t.forEach((e,t)=>{l.push(e.offsetWidth),n.push(e.offsetHeight),a+=e.clientWidth,window_width_adjusted<=a&&(a=e.clientWidth,s.push(t))}),console.log(t),s.forEach((e,a)=>{if(console.log("chapter: ",e),e!=s.slice(-1)[0]){console.log("chapterの最後の要素ではない");for(let l=e;l<s[a+1];l++)if(console.log("i=",l),l==e&&t[l].classList.contains("phrase_end")&&t[l-1].classList.contains("phrase_end")){console.log("@@@if@@@");const e=document.createElement("br");e.className=`${l}`,t[l].before(e)}else if(l==e&&t[l].classList.contains("phrase_end")&&!t[l-1].classList.contains("phrase_end")){console.log("@@@elif1@@@");const e=document.createElement("br");e.className=`${l}`,t[o[o.indexOf(l)-1]].after(e)}else if(l!=e||t[l].classList.contains("phrase_end")){console.log("@@@else@@@"),document.createElement("br").className=`${l}`}else{let a;console.log("@@@elif2@@@:chapter",e),console.log(getPhraseEndList(t)),getPhraseEndList(t).forEach(e=>{console.log(l,e),e<l&&(a=e)}),console.log("tmp",a);const s=document.createElement("br");s.className=`${l}`,console.log([a,t]),t[a+1].before(s)}}else{console.log("chapterの最後の要素");for(let a=e;a<t.length;a++)if(console.log("i=",a),a==e&&t[a].classList.contains("phrase_end")){console.log("+++if+++");const e=document.createElement("br");e.className=`${a}`,t[o[o.indexOf(a)-1]].after(e)}else if(a==e){let e;console.log("+++elif+++"),getPhraseEndList(t).forEach(t=>{t<a&&(e=t)}),console.log("tmp",e);const s=document.createElement("br");s.className=`${a}`,t[e+1].before(s)}}}),console.log("chapters: ",s),console.log("phrase_end: ",getPhraseEndList(t))}else t.length})}function sumFront(e,t){let a=0;for(let s=0;s<t;s++)a+=e[s]}function sumPart(e,t,a){let s=0;for(let l=t;l<a;l++)s+=e[l]}function collapseAsymmetric(e){const t=document.querySelectorAll(`[class~="formula-${e}"`);let a=0,s=0;const l=[],n=[],o=[],c=[];let r=null,i=null,m=null;if(katex_list[e].classList.contains("collapsed"));else if(t.forEach((e,t)=>{e.classList.contains("left")?(a++,l.push(e.clientHeight),o.push(e)):(s++,n.push(e.clientHeight),c.push(e)),a=0,s=0}),o.forEach((e,t)=>{0==t&&(r=e),t<o.length-1&&e.classList.add("gradation")}),c.forEach((e,t)=>{t<c.length-1?(e.classList.add("gradation"),e.style.display="none",e.previousElementSibling.style.display="none"):m=e}),i=c[1],null!=r&&null!=m){const t=m.parentElement.style.top;i.parentElement.style.top;m.parentElement.style.top=r.parentElement.style.top;const a=Math.max(r.clientHeight,m.clientHeight);katex_list[e].style.height=`${a}px`,katex_list[e].classList.add("collapsed",`${t}`),katex_list[e].classList.remove("expanded")}}function collapseHorizontal(e){let t=0,a=0,s=0;const l=Array.from(katex_list[e].children);l.forEach((e,l)=>{e.classList.contains("leftmost")?t=l:e.classList.contains("rightmost")&&(a=l,s++)}),a=a-s+1,l.forEach((e,s)=>{t<s&&s<a&&(e.style.display="none",e.classList.add("gradation"))}),katex_list[e].classList.remove("expanded"),katex_list[e].classList.add("collapsed")}function collapseHorizontalOnMounted(e){let t=0,a=0,s=0;const l=Array.from(katex_list[e].children);l.forEach((e,l)=>{e.classList.contains("leftmost")?t=l:e.classList.contains("rightmost")&&(a=l,s++)}),a=a-s+1,l.forEach((e,s)=>{t<s&&s<a&&(e.style.display="none",e.classList.add("gradation"))}),katex_list[e].classList.add("collapsed")}function collapseMultiColumnsSymmetric(e){const t=document.querySelectorAll(`[class~="formula-${e}"`),a=Array.from(katex_list[e].getElementsByClassName("left")),s=[],l=a.length;a.forEach((e,t)=>{s.push(e.parentElement.style.top)}),katex_list[e].classList.add(`${s.slice(-1)[0]}`),t.forEach((e,t)=>{const a=e.className.match(/row-(\d)/)[1];a>0&&a<l-1?(e.style.display="none",e.classList.add("gradation")):a==l-1&&(e.parentElement.style.top=s[1])}),katex_list[e].classList.add("collapsed"),katex_list[e].classList.remove("expanded")}function expandMultiColumnsSymmetric(e){const t=document.querySelectorAll(`[class~="formula-${e}"`),a=Array.from(katex_list[e].getElementsByClassName("left")),s=[],l=a.length;let n=0;a.forEach((e,t)=>{s.push(e.parentElement.style.top)}),t.forEach((t,a)=>{const s=t.className.match(/row-(\d)/)[1];s>0&&s<l-1?t.style.display="":s==l-1&&(Array.from(katex_list[e].classList).forEach((e,t)=>{e.match(/\w+em/g)&&(n=e)}),t.parentElement.style.top=n)}),katex_list[e].classList.add("expanded"),katex_list[e].classList.remove("collapsed")}function collapseStraight(e){document.getElementsByClassName("katex-html");const t=document.querySelectorAll(`[class~="formula-${e}"`);t.forEach((e,a)=>{a>0&&a<t.length-1&&(e.style.display="none")})}function collapseSymmetric(e){Array.from(document.getElementsByClassName("dots")).forEach((e,t)=>{e.classList.add("gradation"),e.style.display="none"});const t=document.querySelectorAll(`[class~="formula-${e}"`),a=[],s=[],l=[],n=[],o=[],c=[],r=[],i=[];let m=0;t.forEach((e,t)=>{e.classList.contains("left")?(a.push(e.clientHeight),l.push(e)):(m++,s.push(e.clientHeight),n.push(e))});const d=[];l.length!=n.length?d.push(l.slice(0,m-1),l.slice(m-1)):d.push(l),d.forEach((e,t)=>{e.forEach((a,s)=>{s==e.length-1&&c.push(a),t==d.length-1&&0==s&&o.push(a);const l=a.className.match(/row-(\d)/)[1];0!=l&&l!=m-1&&(a.style.display="none",a.previousElementSibling.style.display="none",a.classList.add("gradation"))})}),n.forEach((e,t)=>{}),n.forEach((e,t)=>{0==t?r.push(e):t>0&&t<n.length-1?(e.style.display="none",e.previousElementSibling.style.display="none"):i.push(e)});let h=0,p=0;try{0!=i.length&&(h=i[0].parentElement.style.top,p=o[0].parentElement.nextElementSibling.style.top)}catch(e){console.error(e)}c.forEach(e=>{e.parentElement.style.top=p}),i.forEach(e=>{e.parentElement.style.top=p});let f=0,g=0;o.forEach((e,t)=>{f=0==t?e.clientHeight:Math.max(f,e.clientHeight)}),r.forEach((e,t)=>{f=Math.max(f,e.clientHeight)}),c.forEach((e,t)=>{g=0==t?e.clientHeight:Math.max(g,e.clientHeight)}),i.forEach((e,t)=>{g=Math.max(g,e.clientHeight)}),katex_list[e].style.height=`${f+g}px`,katex_list[e].classList.add("collapsed",`${h}`),katex_list[e].classList.remove("expanded")}function collapseSymmetricOnMounted(e){const t=document.getElementsByClassName("katex-html"),a=document.querySelectorAll(`[class~="formula-${e}"`),s=[],l=[],n=[],o=[],c=[],r=[],i=[],m=[];let d=0;a.forEach((e,t)=>{e.classList.contains("left")?(s.push(e.clientHeight),n.push(e)):(d++,l.push(e.clientHeight),o.push(e))});const h=[];n.length!=o.length?h.push(n.slice(0,d-1),n.slice(d-1)):h.push(n),h.forEach((e,t)=>{e.forEach((a,s)=>{s==e.length-1&&r.push(a),t==h.length-1&&0==s&&c.push(a);const l=a.className.match(/row-(\d)/)[1];0!=l&&l!=d-1&&(a.style.display="none",a.previousElementSibling.style.display="none",a.classList.add("gradation"))})}),o.forEach((e,t)=>{0==t?i.push(e):t>0&&t<o.length-1?(e.style.display="none",e.previousElementSibling.style.display="none",e.classList.add("gradation")):m.push(e)});let p=0,f=0;0!=m.length&&(p=m[0].parentElement.style.top,f=c[0].parentElement.nextElementSibling.style.top),r.forEach(e=>{e.parentElement.style.top=f}),m.forEach(e=>{e.parentElement.style.top=f});let g=0,u=0;c.forEach((e,t)=>{g=0==t?e.clientHeight:Math.max(g,e.clientHeight)}),i.forEach((e,t)=>{g=Math.max(g,e.clientHeight)}),r.forEach((e,t)=>{u=0==t?e.clientHeight:Math.max(u,e.clientHeight)}),m.forEach((e,t)=>{u=Math.max(u,e.clientHeight)}),t[e].style.height=`${g+u}px`,t[e].classList.add("collapsed",`${p}`),t[e].classList.remove("expanded")}function createToggle(e,t,a){const s=document.createElement("div");s.classList.add("switch","katex-toolbar",`kib-${e}`,"py-1");let l="";l=katex_list[e].classList.contains("symmetric")?"symmetric":katex_list[e].classList.contains("asymmetric")?"asymmetric":katex_list[e].classList.contains("horizontal")?"horizontal":katex_list[e].classList.contains("horizontal-combined")?"horizontal-combined":katex_list[e].classList.contains("mcsymmetric")?"mcsymmetric":"none",s.innerHTML=function(e,t,a){let s="checked",l="expand-btn";return t||(s=""),a||(l="collapse-btn"),`<label class="switch__label">\n      <input type="checkbox" ${s} class="switch__input katex-extension-button ${e} ${l}"/>\n      <span class="switch__content"></span><span class="switch__circle"></span></label>`}(l,t,a),katex[e].parentElement.classList.contains("katex-display")?katex[e].parentElement.parentElement.after(s):(s.style.display="inline",s.style.position="relative",katex[e].after(s))}function expandAsymmetric(e){const t=document.getElementsByClassName("katex-html"),a=document.querySelectorAll(`[class~="formula-${e}"`),s=[],l=[];if(t[e].classList.contains("expanded"));else{t[e].style.height="",t[e].classList.remove("collapsed"),t[e].classList.add("expanded");let n="";const o=Array.from(t[e].classList),c=/\w+em/g;o.forEach((a,s)=>{a.match(c)&&(n=t[e].classList[s])}),a.length,a.forEach((e,t)=>{e.style.display="",e.previousElementSibling.style.display="",t==a.length-1&&(e.parentElement.style.top=n),e.classList.contains("left")?s.push(e):l.push(e)})}}function expandHorizontal(e){let t=0,a=0,s=0;Array.from(katex_list[e].children).forEach((e,l)=>{e.classList.contains("leftmost")?t=l:e.classList.contains("rightmost")&&(a=l,s++)}),a=a-s+1,Array.from(katex_list[e].children).forEach((e,s)=>{t<s&&s<a&&(e.style.display="")}),katex_list[e].classList.remove("collapsed"),katex_list[e].classList.add("expanded")}function expandSymmetric(e){Array.from(document.getElementsByClassName("dots")).forEach((e,t)=>{e.style.display=""});const t=document.getElementsByClassName("katex-html"),a=document.querySelectorAll(`[class~="formula-${e}"`);if(t[e].classList.contains("expanded"));else{t[e].style.height="",t[e].classList.remove("collapsed"),t[e].classList.add("expanded");let s="";Array.from(t[e].classList).forEach((a,l)=>{a.match(/\w+em/g)&&(s=t[e].classList[l])});const l=[];a.forEach(e=>{l.push(e.className.match(/row-(\d)/)[1])});const n=Math.max(...l);a.forEach((e,t)=>{e.style.display="",e.previousElementSibling.style.display="",e.className.match(/row-(\d)/)[1]==n&&(e.parentElement.style.top=s)})}}function fireStoreDocExists(){firebase.auth().currentUser&&firebase.firestore().collection(CollectionName).doc(firebase.auth().currentUser.uid).get().then(e=>{})}function fireStoreSaveDocField(){firebase.auth().currentUser&&firebase.firestore().collection(CollectionName).doc(firebase.auth().currentUser.uid).set({displayName:firebase.auth().currentUser.displayName,email:firebase.auth().currentUser.email,uid:firebase.auth().currentUser.uid}).then(()=>{})}function fireStoreSaveLog(e,t){const a=Array.from(document.getElementsByClassName("katex-mathml"));firebase.firestore().collection(CollectionName).doc(firebase.auth().currentUser.uid).collection("history").doc(getUniqueStr(811)).set({action:t,locale:(new Date).toLocaleString(),href:window.location.href,id:e,tex:a[e].innerText,timestamp:Date.now()}).then(()=>{})}function fireStoreSaveLogAll(e,t){const a=Array.from(document.getElementsByClassName("katex-mathml"));firebase.firestore().collection(CollectionAll).doc(getUniqueStr(999)).set({displayName:firebase.auth().currentUser.displayName,email:firebase.auth().currentUser.email,uid:firebase.auth().currentUser.uid,action:t,locale:(new Date).toLocaleString(),href:window.location.href,id:e,tex:a[e].innerText,timestamp:Date.now()}).then(()=>{})}function getUniqueStr(e){let t=1e3;return e&&(t=e),(new Date).getTime().toString(16)+Math.floor(t*Math.random()).toString(16)}async function setToggleDetail(e,t,a,s){"symmetric"==a?e.addEventListener("change",a=>{e.checked?(a.target.classList.remove("collapse-btn"),a.target.classList.add("expand-btn"),a.target.classList.remove(`scbtn-${t}`),a.target.classList.add(`sebtn-${t}`),collapseSymmetric(t),saveKatexStatus(t,1)):(a.target.classList.remove("expand-btn"),a.target.classList.add("collapse-btn"),a.target.classList.remove(`sebtn-${t}`),a.target.classList.add(`scbtn-${t}`),expandSymmetric(t),saveKatexStatus(t,0))}):"asymmetric"==a?e.addEventListener("change",a=>{e.checked?(a.target.classList.remove("collapse-btn"),a.target.classList.add("expand-btn"),a.target.classList.remove(`acbtn-${t}`),a.target.classList.add(`aebtn-${t}`),collapseAsymmetric(t),saveKatexStatus(t,1)):(a.target.classList.remove("expand-btn"),a.target.classList.add("collapse-btn"),a.target.classList.remove(`aebtn-${t}`),a.target.classList.add(`acbtn-${t}`),expandAsymmetric(t),saveKatexStatus(t,0))}):"mcsymmetric"==a?e.addEventListener("change",a=>{e.checked?(a.target.classList.remove("collapse-btn"),a.target.classList.add("expand-btn"),a.target.classList.remove(`mcbtn-${t}`),a.target.classList.add(`mebtn-${t}`),collapseMultiColumnsSymmetric(t),saveKatexStatus(t,1)):(a.target.classList.remove("expand-btn"),a.target.classList.add("collapse-btn"),a.target.classList.remove(`mebtn-${t}`),a.target.classList.add(`mcbtn-${t}`),expandMultiColumnsSymmetric(t),saveKatexStatus(t,0))}):"horizontal"==a&&e.addEventListener("change",a=>{e.checked?(a.target.classList.remove("collapse-btn"),a.target.classList.add("expand-btn"),a.target.classList.remove(`hcbtn-${t}`),a.target.classList.add(`hebtn-${t}`),collapseHorizontal(t),saveKatexStatus(t,1)):(a.target.classList.remove("expand-btn"),a.target.classList.add("collapse-btn"),a.target.classList.remove(`hebtn-${t}`),a.target.classList.add(`hcbtn-${t}`),expandHorizontal(t),saveKatexStatus(t,0))})}async function katexCollapsible(e=!0,t=!0,a){await getKatex(),await loadKaTeX(),await addOrdinalNumberClass(),await addClassHorizontal(),await addClassVertical(),await addStyle();getKatexOverFlowX();addStyleOverFlowXAuto(),e&&katexHTMLClass.forEach((e,t)=>{katexClass[t].parentElement.classList.contains("katex-display")?katexHTMLClass[t].classList.add("display"):katexHTMLClass[t].classList.add("inline"),e.classList.contains("symmetric")?1==a[t]?(collapseSymmetric(t),createToggle(t,1,!0)):createToggle(t,0,!1):e.classList.contains("straight")?collapseStraight(t):e.classList.contains("asymmetric")?1==a[t]?(collapseAsymmetric(t),createToggle(t,1,!0)):createToggle(t,0,!1):e.classList.contains("mcsymmetric")?1==a[t]?(collapseMultiColumnsSymmetric(t),createToggle(t,1,!0)):createToggle(t,0,!1):e.classList.contains("horizontal")?1==a[t]?(collapseHorizontal(t),createToggle(t,1,!0)):createToggle(t,0,!1):e.classList.contains("horizontal-combined")});const s=Array.from(document.getElementsByClassName("katex-extension-button"));let l=null;s.forEach((e,t)=>{l=e.classList[2],setToggleDetail(e,e.parentElement.parentElement.classList[2].split("-")[1],l)})}export default(e,t)=>{t("katexCollapsible",katexCollapsible),t("add",addClassVertical)};export{allCollapse,allExpand,getUniqueStr,CollectionName,CollectionAll};